package com.acv.cheerz;import java.util.List;import android.app.TabActivity;import android.content.Intent;import android.os.Bundle;import android.os.Handler;import android.support.v4.app.Fragment;import android.support.v4.app.FragmentManager;import android.support.v4.widget.DrawerLayout;import android.util.Log;import android.view.View;import android.widget.AdapterView;import android.widget.AdapterView.OnItemClickListener;import android.widget.TabHost;import android.widget.TabHost.TabSpec;import com.acv.cheerz.activity.RootActivity;import com.acv.cheerz.db.User;import com.acv.cheerz.service.CheerzServiceCallBack;import com.acv.cheerz.util.CheerzUtils;import com.acv.cheerz.view.MenuLeftView;import com.acv.cheerz.view.MenuLeftView.IMenuLeftOnClick;@SuppressWarnings("deprecation")public class OverMainActivity extends TabActivity {	private MenuLeftView menuLeftView;	private android.support.v4.widget.DrawerLayout slideMenu;	private String TAG = "OverMainActivity";	@Override	protected void onCreate(Bundle savedInstanceState) {		super.onCreate(savedInstanceState);		setContentView(R.layout.over_slide_main);		slideMenu = (android.support.v4.widget.DrawerLayout) findViewById(R.id.drawer_layout);		((CheerzApplication) getApplication()).initService(cheerzServiceCallBack);		menuLeftView = (MenuLeftView) findViewById(R.id.menuleft);		menuLeftView.setOnItemClickListener(onItemClickListener);		menuLeftView.setiMenuLeftOnClick(new IMenuLeftOnClick() {			@Override			public void onClickItem(final int resId) {				slideMenu.closeDrawers();				if (resId == R.string.logout) {					User.setUnLogin(OverMainActivity.this);					onInit();				} else					new Handler().postDelayed(new Runnable() {						@Override						public void run() {							Intent intent = new Intent(OverMainActivity.this, RootActivity.class);							Bundle extras = new Bundle();							// extras.putString("type", resId == R.id.login ?							// "login" : "register");							if (resId == R.id.login) {								extras.putString("type", "login");							} else if (resId == R.id.register) {								extras.putString("type", "register");							} else if (resId == R.id.item1) {								extras.putString("type", "edit_profile");							}							intent.putExtras(extras);							startActivity(intent);						}					}, 200);			}		});	}	private OnItemClickListener onItemClickListener = new OnItemClickListener() {		@Override		public void onItemClick(final AdapterView<?> parent, final View view, final int position, long id) {			slideMenu.closeDrawers();			slideMenu.closeDrawers();			new Handler().postDelayed(new Runnable() {				@Override				public void run() {					Integer integer = (Integer) parent.getItemAtPosition(position);					if (integer == R.string.edit_profile) {						gotoPage(R.string.edit_profile);					} else if (integer == R.string.logout) {						User.setUnLogin(OverMainActivity.this);						onInit();					} else if (integer == R.string.setting) {						if (CheerzUtils.isLogin(getApplicationContext())) {							gotoPage(R.string.setting);						} else {							startLogin();						}					} else if (integer == R.string.earn_points) {						gotoPageZ(R.string.earn_points);						Log.i(TAG, "switch to view earn-point");					} else if (integer == R.string.ranking) {						gotoPageZ(R.string.ranking);					} else if (integer == R.string.favorite) {						gotoPageZ(R.string.favorite);					} else if (integer == R.string.activities_log) {						gotoPageZ(R.string.activities_log);					}				}			}, 200);		}	};	protected void gotoPageZ(int setting) {		Intent intent = new Intent(this, RootActivity.class);		intent.putExtra("type", getString(setting));		startActivity(intent);	}	protected void onPause() {		super.onPause();		slideMenu.closeDrawers();	};	protected void gotoPage(int setting) {		Intent intent = new Intent(this, RootActivity.class);		intent.putExtra("type", getString(setting));		startActivity(intent);	}	private CheerzServiceCallBack cheerzServiceCallBack = new CheerzServiceCallBack() {		public void onInitSuccess() {			addTab(RootActivity.class, "home", "home", "home");			// addTab(RootActivity.class, "home1", "home1", "home1");			// addTab(RootActivity.class, "home2", "home2", "hom2");			// addTab(RootActivity.class, "hom3", "hom3", "hom3");			// addTab(RootActivity.class, "A", "A", "A");		};	};	public void addTab(Class<?> activity, String tabSpect, String indicator, String type) {		TabHost tabHost = (TabHost) findViewById(android.R.id.tabhost);		TabSpec firstTabSpec = tabHost.newTabSpec(tabSpect);		Intent intent = new Intent(this, activity);		Bundle extras = new Bundle();		extras.putString("type", type);		intent.putExtras(extras);		firstTabSpec.setIndicator(indicator).setContent(intent);		tabHost.addTab(firstTabSpec);	}	@Override	protected void onResume() {		super.onResume();		onInit();	}	private void onInit() {		menuLeftView.initData();	}	public void openMenuLeft() {		slideMenu.openDrawer(findViewById(R.id.menuleftx));	}	public void startLogin() {		Intent intent = new Intent(OverMainActivity.this, RootActivity.class);		Bundle extras = new Bundle();		extras.putString("type", "login");		intent.putExtras(extras);		startActivity(intent);	}	public void enableMenu(boolean b) {		// slideMenu.setEnabled(b);		if (b == false)			slideMenu.setDrawerLockMode(DrawerLayout.LOCK_MODE_LOCKED_CLOSED);		else			slideMenu.setDrawerLockMode(DrawerLayout.LOCK_MODE_UNLOCKED);	}}